<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Spidey Spoken English Coach ğŸ•·ï¸ğŸ‡®ğŸ‡³</title>
  
  <!-- Kid-perfect fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Comic+Neue:wght@700&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <div class="frame">
    <!-- LEFT PANEL â€” SPIDEY -->
    <div class="panel left" role="main" aria-label="Spidey Coach">
      <h1>Speak English with Spidey! ğŸ•·ï¸ğŸ‡®ğŸ‡³</h1>
      <p class="subtitle" style="text-align:center; margin: -10px 0 20px; color:#d6336c; font-weight:600;">
        Practice speaking confidently â€¢ Zero judgment â€¢ Just fun!
      </p>

      <!-- 3D Avatar Container -->
      <div id="canvas-container" aria-label="Spidey 3D Avatar">
        <div id="avatar-scroll-safe"></div>
      </div>

      <!-- Controls -->
      <div class="controls" role="toolbar">
        <button id="micBtn" class="big-red">ğŸ¤ Start Speaking Practice</button>
        <button id="pauseTtsBtn" class="secondary">â¸ Pause</button>
        <button id="resumeTtsBtn" class="secondary" style="display:none">â–¶ Resume</button>
        <button id="stopTtsBtn" class="secondary">â¹ Stop</button>
        <button id="testBtn" class="secondary">ğŸ§ª Test Me</button>
        <div id="status" class="meta" aria-live="polite">Ready when you are!</div>
      </div>

      <footer class="small">
        Speak naturally â€¢ Spidey listens, corrects gently, and helps you shine âœ¨<br>
        Works on phone, tablet, laptop â€¢ Made with â¤ï¸ for Indian kids
      </footer>
    </div>

    <!-- RIGHT PANEL â€” CONVERSATION + SETTINGS -->
    <div class="panel right" role="complementary">
      <h1>Your Practice Session</h1>

      <!-- Typed input -->
      <div style="display:flex; gap:8px; margin-bottom:12px">
        <input id="chatInput" type="text" placeholder="Type anything to practice..." aria-label="Type message" />
        <button id="sendBtn" class="secondary">Send</button>
      </div>

      <!-- Conversation Area -->
      <div id="conversationScroll" class="scroll-area">
        <div id="transcript" class="bubble user" style="display:none"></div>
        <div id="reply" class="bubble"></div>
      </div>

      <!-- Mode Toggle (NEW - Casual vs Practice) -->
      <div style="margin:24px 0 16px; text-align:center">
        <strong style="color:#ff6b6b; display:block; margin-bottom:8px">Conversation Mode</strong>
        <button id="modeToggle" class="mode-toggle">
          <span class="mode-text">Casual Chat</span>
          <div class="mode-switch"></div>
        </button>
        <p class="small" style="margin-top:8px; color:#868e96">
          Casual = fun chat â€¢ Practice = grammar correction + repeat
        </p>
      </div>

      <!-- Quick Class Selection -->
      <div style="margin-top:8px">
        <strong style="color:#ff6b6b">Choose Your Class</strong>
        <div id="classButtons" style="display:flex; gap:12px; margin-top:8px; flex-wrap:wrap">
          <button class="class-btn active" data-class="class3">Class 3</button>
          <button class="class-btn" data-class="class7">Class 7</button>
          <button class="class-btn" data-class="class10">Class 10</button>
        </div>
      </div>

      <!-- Action Buttons -->
      <div style="margin-top:20px; display:flex; gap:12px">
        <button id="clearBtn" class="secondary" style="flex:1">ğŸ—‘ï¸ New Session</button>
        <button id="demoLessonBtn" class="secondary" style="flex:1">ğŸ¯ Daily Challenge</button>
      </div>

      <!-- Log / Debug -->
      <div style="margin-top:16px">
        <strong>Status Log</strong>
        <div id="log" class="small" style="margin-top:8px; color:#868e96"></div>
      </div>
    </div>
  </div>

  <!-- Markdown + Sanitizer -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>

  <!-- App Entry -->
  <script type="module" src="/src/app.js"></script>
</body>
</html>
